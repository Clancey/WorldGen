services:
  worldgen:
    build: .
    container_name: worldgen
    restart: unless-stopped

    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]

    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - HF_TOKEN=${HF_TOKEN}

    volumes:
      - ./output:/app/output
      - ./input:/app/input
      - hf_cache:/root/.cache/huggingface

    ports:
      - "5000:5000"   # Web UI
      - "8080:8080"   # Viser 3D viewer

volumes:
  hf_cache:
